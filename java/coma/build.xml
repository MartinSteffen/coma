<!--         @author: Mohamed Z. Albari          -->
<!-- This is an ant script for installting coma  -->
<!-- To use it please adjust the path definition -->
<!-- according to your system requirments        -->
<project name="admin" default="compile" basedir=".">

	<property name="compile.debug" value="true"/>
	<property name="compile.deprecation" value="false"/>
	<property name="compile.optimize" value="true"/>
	
	<property name="app.name" value="coma" />
	<property name="basedir" value="." />
	<property name="src" value="${basedir}/src" />
	<property name="bin" value="${basedir}/bin" />
	<property name="doc" value="${basedir}/doc" />
	<property name="dist" value="${basedir}/dist" />
	<property name="style" value="${basedir}/style" />
	<property name="papers" value="${basedir}/papers" />
	
	<!-- To install coma adjust the following tow lines accoring to -->
	<!-- your wished installation path -->
	<!--property name="catalina.home" value="/etc/tomcat5" /-->
	<!--property name="webapp.home" value="/home/wprguest3/webapps/" /-->
	<property name="catalina.home" value="/etc/tomcat" />
	<property name="webapp.home" value="/home/ziad/webapps/" />
	<property name="lib" value="/home/ziad/projects/lib" />
	<property name="doc_home" value="/home/ziad/public_html" />
    <!--                         END                                -->
	
	<path id="compile.classpath">
		<!--
		<pathelement location="${catalina.home}/common/classes" />
		<pathelement location="${catalina.home}/shared/classes" />
		
		<fileset dir="${catalina.home}/common/endorsed">
			<include name="*.jar" />
		</fileset>
		<fileset dir="${catalina.home}/common/lib">
			<include name="*.jar" />
		</fileset>
		-->
		<fileset dir="${lib}">
			<include name="*.jar" />
		</fileset>
	</path>

	<target name="clean" description="deleting old build ...">
			<delete dir="${bin}" />
			<delete dir="${doc}" />
			<delete dir="${dist}" />
			<delete dir="${app.name}" />
    </target>
	
	<target name="compile" depends="clean" description="compiling sources ...">
		<mkdir dir="${bin}" />
		<javac srcdir="${src}" destdir="${bin}"
		       deprecation="${compile.deprecation}"
			   debug="${compile.debug}"
			   optimize="${compile.optimize}"
		>	
			<classpath refid="compile.classpath" />
		</javac>
	</target>
	<target name="doc" depends="clean" description="generating java docs ...">
			<mkdir dir="${doc}/api" />
			<javadoc sourcepath="${src}" destdir="${doc}/api" packagenames="*">
				<classpath refid="compile.classpath" />
			</javadoc>
	</target>

	<target name="install" depends="compile, doc" description="installing application">
		<mkdir dir="${dist}/${app.name}/WEB-INF/classes" />
		<mkdir dir="${dist}/${app.name}/style" />
		<mkdir dir="${dist}/${app.name}/papers" />
		<copy todir="${dist}/${app.name}/WEB-INF/classes">
			<fileset dir="${bin}/" />
		</copy>
		<copy todir="${doc_home}">
			<fileset dir="${doc}" />
		</copy>
		<copy todir="${dist}/${app.name}/style">
			<fileset dir="${style}/"/>
		</copy>
		<copy todir="${dist}/${app.name}/WEB-INF" file="${basedir}/web.xml" />
		<copy todir="${dist}/${app.name}/index.html" file="${basedir}/index.html" />
		<!-- uncomment this line and be sure that you are authorized to rewrite -->
		<!-- the directory /CATALINAE_HOME/conf/Catalina/localhost -->
		<copy todir="${catalina.home}/conf/Catalina/localhost/" file="${basedir}/${app.name}.xml" overwrite="true" />

		<delete dir="${webapp.home}/${app.name}" />
		<copy todir="${webapp.home}" overwrite="true">
			<fileset dir="${dist}/" />
		</copy>

	</target>

</project>