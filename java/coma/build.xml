<project name="admin" default="compile" basedir=".">

	<property name="app.name" value="coma" />
	<property name="basedir" value="." />
	<property name="src" value="${basedir}/src" />
	<property name="bin" value="${basedir}/bin" />
	<property name="doc" value="${basedir}/doc" />
	<property name="dist" value="${basedir}/dist" />
	<property name="lib" value="${basedir}/lib" />
	<property name="style" value="${basedir}/style" />
	
	<property name="catalina.home" value="/home/tomcat" />
	<property name="webapp.home" value="${catalina.home}/webapps/" />

	<path id="compile.classpath">
		<pathelement location="${catalina.home}/common/classes" />
		<pathelement location="${catalina.home}/shared/classes" />
		<fileset dir="${catalina.home}/commnon/endorsed">
			<include name="*.jar" />
		</fileset>
		<fileset dir="${catalina.home}/common/lib">
			<include name="*.jar" />
		</fileset>
		<fileset dir="${lib}">
			<include name="*.jar" />
		</fileset>
	</path>

	<target name="compile" depends="clean" description="compiling sources ...">
		<mkdir dir="${bin}" />
		<javac srcdir="${src}" destdir="${bin}">
			<classpath refid="compile.classpath" />
		</javac>
	</target>

	<target name="clean" description="deleting old build ...">
		<delete dir="${bin}" />
		<delete dir="${doc}" />
		<delete dir="${dist}" />
		<delete dir="${app.name}" />
	</target>

	<target name="build" depends="compile, doc" description="installing application">
		<mkdir dir="${dist}/${app.name}/WEB-INF/classes" />
		<copy todir="${dist}/${app.name}/WEB-INF/classes">
			<fileset dir="${bin}/" />
		</copy>
		<copy todir="${dist}/${app.name}">
			<fileset dir="${doc}" />
		</copy>
		<copy todir="${dist}/${app.name}">
			<fileset dir="${style}"/>
		</copy>
		<copy todir="${dist}/${app.name}/WEB-INF" file="${basedir}/web.xml" />
		<copy todir="${catalina.home}/conf/Catalina/localhost/" file="${basedir}/${app.name}.xml" overwrite="true" />

		<delete dir="${webapp.home}/${app.name}" />
		<copy todir="${webapp.home}" overwrite="true">
			<fileset dir="${dist}/" />
		</copy>

	</target>

	<target name="doc" depends="clean" description="generating java docs ...">
		<mkdir dir="${doc}/api" />
		<javadoc sourcepath="${src}" destdir="${doc}/api" packagenames="*">
			<classpath refid="compile.classpath" />
		</javadoc>
	</target>

</project>